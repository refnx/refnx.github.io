
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>refnx.analysis package &#8212; refnx 0.0.13.dev0+ documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.13.dev0+',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="refnx-analysis-package">
<h1>refnx.analysis package<a class="headerlink" href="#refnx-analysis-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-refnx.analysis.curvefitter">
<span id="refnx-analysis-curvefitter-module"></span><h2>refnx.analysis.curvefitter module<a class="headerlink" href="#module-refnx.analysis.curvefitter" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="refnx.analysis.curvefitter.CurveFitter">
<em class="property">class </em><code class="descclassname">refnx.analysis.curvefitter.</code><code class="descname">CurveFitter</code><span class="sig-paren">(</span><em>objective</em>, <em>nwalkers=200</em>, <em>ntemps=-1</em>, <em>**mcmc_kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.CurveFitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Analyse a curvefitting system (with MCMC sampling)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>objective</strong> (<a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><em>refnx.analysis.Objective</em></a>) – The <a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Objective</span></code></a> to be analysed.</li>
<li><strong>nwalkers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – How many walkers you would like the sampler to have. Must be an
even number. The more walkers the better.</li>
<li><strong>ntemps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><em>optional</em>) – If <cite>ntemps == -1</cite>, then an <code class="xref py py-class docutils literal"><span class="pre">emcee.EnsembleSampler</span></code> is used
during the <cite>sample</cite> method.
Otherwise, or if <cite>ntemps is None</cite> then parallel tempering is
used with a <code class="xref py py-class docutils literal"><span class="pre">emcee.PTSampler</span></code> object during the <cite>sample</cite>
method, with <cite>ntemps</cite> specifing the number of temperatures. Can be
<cite>None</cite>, in which case the <cite>Tmax</cite> keyword argument sets the maximum
temperature. Parallel Tempering is useful if you expect your
posterior distribution to be multi-modal.</li>
<li><strong>mcmc_kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)"><em>dict</em></a>) – Keywords used to create the <code class="xref py py-class docutils literal"><span class="pre">emcee.EnsembleSampler</span></code> or
<code class="xref py py-class docutils literal"><span class="pre">emcee.PTSampler</span></code> objects.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>See the documentation at <a class="reference external" href="http://dan.iel.fm/emcee/current/api/">http://dan.iel.fm/emcee/current/api/</a> for
further details on what keywords are permitted, and for further
information on Parallel Tempering. The <cite>pool</cite> and <cite>threads</cite> keywords
are ignored here. Specification of parallel threading is done with the
<cite>pool</cite> argument in the <cite>sample</cite> method.</p>
<dl class="method">
<dt id="refnx.analysis.curvefitter.CurveFitter.acf">
<code class="descname">acf</code><span class="sig-paren">(</span><em>nburn=0</em>, <em>nthin=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.acf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.CurveFitter.acf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the autocorrelation function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>acfs</strong> – The autocorrelation function, acfs.shape=(lags, nvary)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.curvefitter.CurveFitter.chain">
<code class="descname">chain</code><a class="headerlink" href="#refnx.analysis.curvefitter.CurveFitter.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>MCMC chain belonging to CurveFitter.sampler</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>chain</strong> – The MCMC chain belonging to CurveFitter.sampler</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)">array</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.curvefitter.CurveFitter.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>method='L-BFGS-B'</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.CurveFitter.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the maximum log-likelihood estimate (mode) of the objective. For
a least-squares objective this would correspond to lowest chi2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – <p>which method to use for the optimisation. One of:</p>
<ul>
<li><cite>’least_squares’</cite>: <cite>scipy.optimize.least_squares</cite>.</li>
<li><cite>’L-BFGS-B’</cite>: L-BFGS-B</li>
<li><cite>’differential_evolution’</cite>: differential evolution</li>
</ul>
<p>You can also choose many of the minimizers from
<code class="docutils literal"><span class="pre">scipy.optimize.minimize</span></code>.</p>
</li>
<li><strong>kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)"><em>dict</em></a>) – Additional arguments are passed to the underlying minimization
method.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result, covar</strong> – <cite>result.x</cite> contains the best fit parameters
<cite>result.covar</cite> is the covariance matrix for the fit.
<cite>result.stderr</cite> is the uncertainties on each of the fit parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">OptimizeResult, np.ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <cite>objective</cite> supplies a <cite>residuals</cite> method then <cite>least_squares</cite>
can be used. Otherwise the <cite>nll</cite> method of the <cite>objective</cite> is
minimised. Use this method just before a sampling run.
If <cite>self.objective.parameters</cite> is a <cite>Parameters</cite> instance, then each
of the varying parameters has its value updated by the fit, and each
<cite>Parameter</cite> has a <cite>stderr</cite> attribute which represents the uncertainty
on the fit parameter.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.curvefitter.CurveFitter.initialise">
<code class="descname">initialise</code><span class="sig-paren">(</span><em>pos='covar'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.initialise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.CurveFitter.initialise" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the emcee walkers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> or </em><em>np.ndarray</em>) – <p>Method for initialising the emcee walkers. One of:</p>
<ul class="simple">
<li>’covar’, use the estimated covariance of the system.</li>
<li>’jitter’, add a small amount of gaussian noise to each parameter</li>
<li>’prior’, sample random locations from the prior</li>
<li><dl class="first docutils">
<dt>pos, an array that specifies a snapshot of the walkers. Has shape</dt>
<dd><dl class="first last docutils">
<dt><cite>(nwalkers, ndim)</cite>, or <cite>(ntemps, nwalkers, ndim)</cite> if parallel</dt>
<dd>tempering is employed. You can also provide a previously
created chain.</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.curvefitter.CurveFitter.initialise_with_chain">
<code class="descname">initialise_with_chain</code><span class="sig-paren">(</span><em>chain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.initialise_with_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.CurveFitter.initialise_with_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise sampler with a pre-existing chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chain</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)"><em>array</em></a>) – Array of size <cite>(ntemps, nwalkers, steps, ndim)</cite> or
<cite>(nwalkers, steps, ndim)</cite>, containing a chain from a previous
sampling run.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.curvefitter.CurveFitter.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><em>steps</em>, <em>nthin=1</em>, <em>random_state=None</em>, <em>f=None</em>, <em>callback=None</em>, <em>verbose=True</em>, <em>pool=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.CurveFitter.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs sampling from the objective.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Iterate the sampler by a number of steps</li>
<li><strong>nthin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – only store every <cite>nthin</cite> samples from the chain. <cite>nthin</cite> should be
a divisor of <cite>steps</cite>.</li>
<li><strong>random_state</strong> (int or <cite>np.random.RandomState</cite>, optional) – If <cite>random_state</cite> is an int, a new <cite>np.random.RandomState</cite> instance
is used, seeded with <cite>random_state</cite>.
If <cite>random_state</cite> is already a <cite>np.random.RandomState</cite> instance,
then that <cite>np.random.RandomState</cite> instance is used. Specify
<cite>random_state</cite> for repeatable sampling</li>
<li><strong>f</strong> (<em>file-like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – File to incrementally save chain progress to. Each row in the file
is a flattened array of size <cite>(nwalkers, ndim)</cite> or
<cite>(ntemps, nwalkers, ndim)</cite>. There should be <cite>steps</cite> rows in the
file.</li>
<li><strong>callback</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a>) – callback function to be called at each iteration step</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – Gives updates on the sampling progress</li>
<li><strong>pool</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>map-like object</em><em>, </em><em>optional</em>) – If <cite>pool</cite> is an <cite>int</cite> then it specifies the number of threads to
use for parallelization. If <cite>pool == 0</cite>, then all CPU’s are used.
If pool is an object with a map method that follows the same
calling sequence as the built-in map function, then this pool is
used for parallelisation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Please see <code class="xref py py-class docutils literal"><span class="pre">emcee.EnsembleSampler</span></code> for its detailed behaviour.
For example, the chain is contained in <cite>CurveFitter.sampler.chain</cite> and
has shape <cite>(nwalkers, iterations, ndim)</cite>. If you wish to ‘burn’ a
number of samples to start with then use the following pattern:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># we&#39;ll burn the first 500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitter</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># after you&#39;ve run those, then discard them by resetting the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># sampler.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitter</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now do a production run only saving 1 in every 50 samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitter</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">nthin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>One can also burn and thin in <cite>Curvefitter.process_chain</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.curvefitter.MCMCResult">
<em class="property">class </em><code class="descclassname">refnx.analysis.curvefitter.</code><code class="descname">MCMCResult</code><span class="sig-paren">(</span><em>name</em>, <em>param</em>, <em>stderr</em>, <em>chain</em>, <em>median</em><span class="sig-paren">)</span><a class="headerlink" href="#refnx.analysis.curvefitter.MCMCResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a></p>
<dl class="attribute">
<dt id="refnx.analysis.curvefitter.MCMCResult.chain">
<code class="descname">chain</code><a class="headerlink" href="#refnx.analysis.curvefitter.MCMCResult.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.curvefitter.MCMCResult.median">
<code class="descname">median</code><a class="headerlink" href="#refnx.analysis.curvefitter.MCMCResult.median" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.curvefitter.MCMCResult.name">
<code class="descname">name</code><a class="headerlink" href="#refnx.analysis.curvefitter.MCMCResult.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.curvefitter.MCMCResult.param">
<code class="descname">param</code><a class="headerlink" href="#refnx.analysis.curvefitter.MCMCResult.param" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.curvefitter.MCMCResult.stderr">
<code class="descname">stderr</code><a class="headerlink" href="#refnx.analysis.curvefitter.MCMCResult.stderr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="refnx.analysis.curvefitter.bounds_list">
<code class="descclassname">refnx.analysis.curvefitter.</code><code class="descname">bounds_list</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#bounds_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.bounds_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (interval) bounds for all varying parameters</p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.curvefitter.load_chain">
<code class="descclassname">refnx.analysis.curvefitter.</code><code class="descname">load_chain</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#load_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.load_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a chain from disk. Does not change the state of a CurveFitter
object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> or </em><em>file-like</em>) – File containing the chain.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>chain</strong> – The loaded chain - <cite>(nwalkers, nsteps, ndim)</cite> or
<cite>(ntemps, nwalkers, nsteps, ndim)</cite></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)">array</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.curvefitter.process_chain">
<code class="descclassname">refnx.analysis.curvefitter.</code><code class="descname">process_chain</code><span class="sig-paren">(</span><em>objective</em>, <em>chain</em>, <em>nburn=0</em>, <em>nthin=1</em>, <em>flatchain=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#process_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.process_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Process the chain produced by a sampler for a given Objective</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>objective</strong> (<a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><em>refnx.analysis.Objective</em></a>) – The Objective function that the Posterior was sampled for</li>
<li><strong>chain</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)"><em>array</em></a>) – The MCMC chain</li>
<li><strong>nburn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – discard this many steps from the start of the chain</li>
<li><strong>nthin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – only accept every <cite>nthin</cite> samples from the chain</li>
<li><strong>flatchain</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – collapse the walkers down into a single dimension.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>[(param, stderr, chain)]</strong> – List of (param, stderr, chain) tuples.
If <cite>isinstance(objective.parameters, Parameters)</cite> then <cite>param</cite> is a
<cite>Parameter</cite> instance. <cite>param.value</cite>, <cite>param.stderr</cite> and
<cite>param.chain</cite> will contain the median, stderr and chain samples,
respectively. Otherwise <cite>param</cite> will be a float representing the
median of the chain samples.
<cite>stderr</cite> is the half width of the [15.87, 84.13] spread (similar to
standard deviation) and <cite>chain</cite> is an array containing the MCMC
samples for that parameter.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The chain should have the shape <cite>(nwalkers, iterations, nvary)</cite> or
<cite>(ntemps, nwalkers, iterations, nvary)</cite> if parallel tempering was
employed.
The burned and thinned chain is created via:
<cite>chain[…, nburn::nthin, :]</cite>.
Note, if parallel tempering is employed, then only the first row
of the parallel tempering chain is processed and returned as it
corresponds to the (lowest energy) target distribution.
If <cite>flatten is True</cite> then the burned/thinned chain is reshaped and
<cite>arr.reshape(-1, nvary)</cite> is returned.
This function has the effect of setting the parameter stderr’s.</p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.curvefitter.uncertainty_from_chain">
<code class="descclassname">refnx.analysis.curvefitter.</code><code class="descname">uncertainty_from_chain</code><span class="sig-paren">(</span><em>chain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#uncertainty_from_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.curvefitter.uncertainty_from_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the median and uncertainty of MC samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chain</strong> (<em>array-like</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>median, stderr</strong> – <cite>median</cite> of the chain samples. <cite>stderr</cite> is half the width of the
[15.87, 84.13] spread.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-refnx.analysis.objective">
<span id="refnx-analysis-objective-module"></span><h2>refnx.analysis.objective module<a class="headerlink" href="#module-refnx.analysis.objective" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="refnx.analysis.objective.BaseObjective">
<em class="property">class </em><code class="descclassname">refnx.analysis.objective.</code><code class="descname">BaseObjective</code><span class="sig-paren">(</span><em>p</em>, <em>lnlike</em>, <em>lnprior=None</em>, <em>fcn_args=()</em>, <em>fcn_kwds=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Don’t necessarily have to use Parameters, could use np.array</p>
<dl class="method">
<dt id="refnx.analysis.objective.BaseObjective.covar">
<code class="descname">covar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.covar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective.covar" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>covar</strong> – The covariance matrix for the fitting system</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.BaseObjective.lnlike">
<code class="descname">lnlike</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.lnlike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Log-likelihood probability function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnlike</strong> – log-likelihood probability.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.BaseObjective.lnprior">
<code class="descname">lnprior</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Log-prior probability function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprior</strong> – log-prior probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.BaseObjective.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Log-probability function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprob</strong> – log-probability.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The log probability is the sum is the sum of the log-prior and
log-likelihood probabilities. Does not set the parameter attribute.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.BaseObjective.nll">
<code class="descname">nll</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.nll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective.nll" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative log-likelihood function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nll</strong> – negative log-likelihood</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.BaseObjective.setp">
<code class="descname">setp</code><span class="sig-paren">(</span><em>pvals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.setp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective.setp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters from pvals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.BaseObjective.varying_parameters">
<code class="descname">varying_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.varying_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.BaseObjective.varying_parameters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>varying_parameters</strong> – The parameters varying in this objective function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.objective.GlobalObjective">
<em class="property">class </em><code class="descclassname">refnx.analysis.objective.</code><code class="descname">GlobalObjective</code><span class="sig-paren">(</span><em>objectives</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.objective.Objective" title="refnx.analysis.objective.Objective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.objective.Objective</span></code></a></p>
<p>Global Objective function for simultaneous fitting with
<cite>refnx.analysis.CurveFitter</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>objectives</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a>) – list of <a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Objective</span></code></a> objects</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="refnx.analysis.objective.GlobalObjective.lnlike">
<code class="descname">lnlike</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective.lnlike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelhood of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnlike</strong> – log-likelihood probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.GlobalObjective.lnprior">
<code class="descname">lnprior</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-prior of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a><em>, </em><em>optional</em>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprior</strong> – log-prior probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.objective.GlobalObjective.npoints">
<code class="descname">npoints</code><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective.npoints" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>int</strong> number of data points in all the objectives.</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.objective.GlobalObjective.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Parameters</span></code></a> associated with all the objectives.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.GlobalObjective.residuals">
<code class="descname">residuals</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective.residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenated residuals for each of the
<a class="reference internal" href="#refnx.analysis.Objective.residuals" title="refnx.analysis.Objective.residuals"><code class="xref py py-meth docutils literal"><span class="pre">refnx.analysis.Objective.residuals</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>residuals</strong> – Concatenated <a class="reference internal" href="#refnx.analysis.Objective.residuals" title="refnx.analysis.Objective.residuals"><code class="xref py py-meth docutils literal"><span class="pre">refnx.analysis.Objective.residuals</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.objective.GlobalObjective.use_weights">
<code class="descname">use_weights</code><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective.use_weights" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>bool</strong> is data weighting being used for all the objectives?</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.objective.GlobalObjective.weighted">
<code class="descname">weighted</code><a class="headerlink" href="#refnx.analysis.objective.GlobalObjective.weighted" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>bool</strong> do all the datasets have y_err?</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.objective.Objective">
<em class="property">class </em><code class="descclassname">refnx.analysis.objective.</code><code class="descname">Objective</code><span class="sig-paren">(</span><em>model</em>, <em>data</em>, <em>lnsigma=None</em>, <em>use_weights=True</em>, <em>transform=None</em>, <em>lnprob_extra=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.objective.BaseObjective" title="refnx.analysis.objective.BaseObjective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.objective.BaseObjective</span></code></a></p>
<p>Objective function for using with curvefitters such as
<cite>refnx.analysis.curvefitter.CurveFitter</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<a class="reference internal" href="#refnx.analysis.Model" title="refnx.analysis.Model"><em>refnx.analysis.Model</em></a>) – the generative model function. One can also provide an object that
inherits <cite>refnx.analysis.Model</cite>.</li>
<li><strong>data</strong> (<a class="reference internal" href="refnx.dataset.html#refnx.dataset.Data1D" title="refnx.dataset.Data1D"><em>refnx.dataset.Data1D</em></a>) – data to be analysed.</li>
<li><strong>lnsigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><a class="reference internal" href="#refnx.analysis.Parameter" title="refnx.analysis.Parameter"><em>refnx.analysis.Parameter</em></a><em>, </em><em>optional</em>) – <p>Used if the  experimental uncertainty (<cite>data.y_err</cite>) underestimated by
a constant fractional amount. The experimental uncertainty is modified
as:</p>
<p><cite>s_n**2 = y_err**2 + exp(lnsigma * 2) * model**2</cite></p>
<p>See <cite>Objective.lnlike</cite> for more details.</p>
</li>
<li><strong>use_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – use experimental uncertainty in calculation of residuals and
lnlike, if available. If this is set to False, then you should also
set <cite>self.lnsigma.vary = False</cite>, it will have no effect on the fit.</li>
<li><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a><em>, </em><em>optional</em>) – the model, data and data uncertainty are transformed by this
function before calculating the likelihood/residuals. Has the
signature <cite>transform(data.x, y, y_err=None)</cite>, returning the tuple
(<cite>transformed_y, transformed_y_err</cite>).</li>
<li><strong>lnprob_extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a><em>, </em><em>optional</em>) – user specifiable log-probability term. This contribution is in
addition to the log-prior term of the <cite>model</cite> parameters, and
<cite>model.lnprob</cite>, as well as the log-likelihood of the <cite>data</cite>. Has
signature:
<cite>lnprob_extra(model, data)</cite>. The <cite>model</cite> will already possess
updated parameters. Beware of including the same log-probability
terms more than once.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For parallelisation <cite>lnprob_extra</cite> needs to be picklable.</p>
<dl class="method">
<dt id="refnx.analysis.objective.Objective.chisqr">
<code class="descname">chisqr</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.chisqr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.chisqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the chi-squared value for a given fitting system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>chisqr</strong> – Chi-squared value, <cite>np.sum(residuals**2)</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.covar">
<code class="descname">covar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.covar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.covar" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the covariance matrix of the curvefitting system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>covar</strong> – Covariance matrix</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.generative">
<code class="descname">generative</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.generative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.generative" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the generative (dependent variable) function associated with
the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>model</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.lnlike">
<code class="descname">lnlike</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.lnlike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelhood of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnlike</strong> – log-likelihood probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The log-likelihood is calculated as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">lnlike</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">model</span> <span class="o">/</span> <span class="n">s_n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">s_n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>where</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">s_n</span><span class="o">**</span><span class="mi">2</span> <span class="o">=</span> <span class="n">y_err</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">lnsigma</span><span class="p">)</span> <span class="o">*</span> <span class="n">model</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.lnprior">
<code class="descname">lnprior</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-prior of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprior</strong> – log-prior probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The log-prior is calculated as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">lnprior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">lnprob</span><span class="p">()</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">varying_parameters</span><span class="p">())</span>
<span class="n">lnprior</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lnprob</span><span class="p">()</span>
<span class="n">lnprior</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lnprob_extra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>The major components of the log-prior probability are from the varying
parameters and the Model used to construct the Objective.
<cite>self.model.lnprob</cite> should not include any contributions from
<cite>self.model.parameters</cite> otherwise they’ll be counted more than once.
The same argument applies to the user specifiable <cite>lnprob_extra</cite>
function.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-probability of the curvefitting system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprob</strong> – log-probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The overall log-probability is the sum of the log-prior and
log-likelihood. The log-likelihood is not calculated if the log-prior
is impossible (<cite>lnprior == -np.inf</cite>).</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.nll">
<code class="descname">nll</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.nll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.nll" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative log-likelihood function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nll</strong> – negative log-likelihood</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.objective.Objective.npoints">
<code class="descname">npoints</code><a class="headerlink" href="#refnx.analysis.objective.Objective.npoints" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>int</strong> the number of points in the dataset.</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.objective.Objective.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.objective.Objective.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Parameters</span></code></a>, all the Parameters contained in the
fitting system.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.pgen">
<code class="descname">pgen</code><span class="sig-paren">(</span><em>ngen=1000</em>, <em>nburn=0</em>, <em>nthin=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.pgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.pgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield random parameter vectors (only those varying) from the MCMC
samples. The objective state is not altered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ngen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – the number of samples to yield. The actual number of samples
yielded is <cite>min(ngen, chain.size)</cite></li>
<li><strong>nburn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – discard this many steps from the start of the chain</li>
<li><strong>nthin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – only accept every <cite>nthin</cite> samples from the chain</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><strong>pvec</strong> (<em>np.ndarray</em>) – A randomly chosen parameter vector</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the data/model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Numeric values for the Parameter’s that are varying</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>fig, ax</strong> – <cite>matplotlib</cite> figure and axes objects.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.Figure</span></code>, <code class="xref py py-class docutils literal"><span class="pre">matplotlib.Axes</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.residuals">
<code class="descname">residuals</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the residuals for a given fitting system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>residuals</strong> – Residuals, <cite>(data.y - model) / y_err</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.setp">
<code class="descname">setp</code><span class="sig-paren">(</span><em>pvals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.setp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.setp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters from pvals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.objective.Objective.varying_parameters">
<code class="descname">varying_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.varying_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Objective.varying_parameters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>varying_parameters</strong> – The varying Parameter objects allowed to vary during the fit.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters">refnx.analysis.Parameters</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.objective.Objective.weighted">
<code class="descname">weighted</code><a class="headerlink" href="#refnx.analysis.objective.Objective.weighted" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>bool</strong> does the data have weights (<cite>data.y_err</cite>)?</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.objective.Transform">
<em class="property">class </em><code class="descclassname">refnx.analysis.objective.</code><code class="descname">Transform</code><span class="sig-paren">(</span><em>form</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.objective.Transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Mathematical transforms of numeric data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>form</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – <p>One of:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>’lin’</dt>
<dd>No transform is made</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’logY’</dt>
<dd>log10 transform</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’YX4’</dt>
<dd>YX**4 transform</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’YX2’</dt>
<dd>YX**2 transform</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>None</dt>
<dd>No transform is made</dd>
</dl>
</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>You ask for a transform to be carried out by calling the Transform object
directly.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="s1">&#39;logY&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_err</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-refnx.analysis.model">
<span id="refnx-analysis-model-module"></span><h2>refnx.analysis.model module<a class="headerlink" href="#module-refnx.analysis.model" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="refnx.analysis.model.Model">
<em class="property">class </em><code class="descclassname">refnx.analysis.model.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>parameters</em>, <em>fitfunc=None</em>, <em>fcn_args=()</em>, <em>fcn_kwds=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.model.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Calculates a generative model (dependent variable), given parameters
and independent variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)"><em>array</em></a><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – Parameters to calculate the model with</li>
<li><strong>fitfunc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a><em>, </em><em>optional</em>) – A function that calculates the generative model. Should have the
signature <code class="docutils literal"><span class="pre">fitfunc(x,</span> <span class="pre">parameters,</span> <span class="pre">*fcn_args,</span> <span class="pre">**fcn__kwds)</span></code> where <cite>x</cite>
is an array-like specifying the independent variables, and
<cite>parameters</cite> are the parameters required to calculate the model.
<cite>fcn_args</cite> and <cite>fcn_kwds</cite> can be used to supply additional arguments to
to <cite>fitfunc</cite>.</li>
<li><strong>fcn_args</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Supplies extra arguments to <cite>fitfunc</cite></li>
<li><strong>fcn_kwds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)"><em>dict</em></a><em>, </em><em>optional</em>) – Supplies keyword arguments to <cite>fitfunc</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>It is not necessary to supply <cite>fitfunc</cite> to create a <cite>Model</cite> <em>iff</em> you are
inheriting <cite>Model</cite> and are also overriding <cite>Model.model</cite>.</p>
<dl class="attribute">
<dt id="refnx.analysis.model.Model.fitfunc">
<code class="descname">fitfunc</code><a class="headerlink" href="#refnx.analysis.model.Model.fitfunc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.model.Model.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#Model.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.model.Model.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>The model can add additional terms to it’s log-probability. However,
it should _not_ include lnprob from any of the parameters. That is
calculated by objective.lnprior.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.model.Model.model">
<code class="descname">model</code><span class="sig-paren">(</span><em>x</em>, <em>p=None</em>, <em>x_err=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#Model.model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.model.Model.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a generative model(dependent variable), given parameters and
independent variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array-like</em>) – Independent variable.</li>
<li><strong>p</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – Parameters to supply to the generative function.</li>
<li><strong>x_err</strong> (<em>optional</em>) – Uncertainty in <cite>x</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>generative</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array-like or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The interpretation of <cite>x</cite>, <cite>p</cite>, and <cite>x_err</cite> is up to the <cite>fitfunc</cite>
supplied during construction of this object (or the overridden <cite>model</cite>
method of this object).</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.model.Model.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.model.Model.parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="refnx.analysis.model.fitfunc">
<code class="descclassname">refnx.analysis.model.</code><code class="descname">fitfunc</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#fitfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.model.fitfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator that can be used to say if something is a fitfunc.</p>
</dd></dl>

</div>
<div class="section" id="module-refnx.analysis.parameter">
<span id="refnx-analysis-parameter-module"></span><h2>refnx.analysis.parameter module<a class="headerlink" href="#module-refnx.analysis.parameter" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="refnx.analysis.parameter.BaseParameter">
<em class="property">class </em><code class="descclassname">refnx.analysis.parameter.</code><code class="descname">BaseParameter</code><a class="reference internal" href="_modules/refnx/analysis/parameter.html#BaseParameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.BaseParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="attribute">
<dt id="refnx.analysis.parameter.BaseParameter.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#refnx.analysis.parameter.BaseParameter.bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.BaseParameter.constraint">
<code class="descname">constraint</code><a class="headerlink" href="#refnx.analysis.parameter.BaseParameter.constraint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.BaseParameter.dependencies">
<code class="descname">dependencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#BaseParameter.dependencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.BaseParameter.dependencies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.BaseParameter.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#BaseParameter.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.BaseParameter.lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.BaseParameter.value">
<code class="descname">value</code><a class="headerlink" href="#refnx.analysis.parameter.BaseParameter.value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.BaseParameter.vary">
<code class="descname">vary</code><a class="headerlink" href="#refnx.analysis.parameter.BaseParameter.vary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.parameter.Constant">
<em class="property">class </em><code class="descclassname">refnx.analysis.parameter.</code><code class="descname">Constant</code><span class="sig-paren">(</span><em>value=0.0</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.parameter.BaseParameter" title="refnx.analysis.parameter.BaseParameter"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.parameter.BaseParameter</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.parameter.MAKE_BINARY">
<code class="descclassname">refnx.analysis.parameter.</code><code class="descname">MAKE_BINARY</code><span class="sig-paren">(</span><em>opfn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#MAKE_BINARY"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.MAKE_BINARY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="refnx.analysis.parameter.MAKE_RBINARY">
<code class="descclassname">refnx.analysis.parameter.</code><code class="descname">MAKE_RBINARY</code><span class="sig-paren">(</span><em>opfn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#MAKE_RBINARY"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.MAKE_RBINARY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="refnx.analysis.parameter.MAKE_UNARY">
<code class="descclassname">refnx.analysis.parameter.</code><code class="descname">MAKE_UNARY</code><span class="sig-paren">(</span><em>opfn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#MAKE_UNARY"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.MAKE_UNARY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="refnx.analysis.parameter.Parameter">
<em class="property">class </em><code class="descclassname">refnx.analysis.parameter.</code><code class="descname">Parameter</code><span class="sig-paren">(</span><em>value=0.0, name=None, bounds=[-inf, inf], vary=False, constraint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.parameter.BaseParameter" title="refnx.analysis.parameter.BaseParameter"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.parameter.BaseParameter</span></code></a></p>
<dl class="attribute">
<dt id="refnx.analysis.parameter.Parameter.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#refnx.analysis.parameter.Parameter.bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.Parameter.constraint">
<code class="descname">constraint</code><a class="headerlink" href="#refnx.analysis.parameter.Parameter.constraint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameter.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>pval=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameter.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of the parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>prob</strong> – log-likelihood probability of the parameter</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameter.range">
<code class="descname">range</code><span class="sig-paren">(</span><em>lower</em>, <em>upper</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameter.range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameter.setp">
<code class="descname">setp</code><span class="sig-paren">(</span><em>value=None</em>, <em>vary=None</em>, <em>bounds=None</em>, <em>constraint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.setp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameter.setp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set several attributes of the parameter at once</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameter.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameter.valid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.Parameter.value">
<code class="descname">value</code><a class="headerlink" href="#refnx.analysis.parameter.Parameter.value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.Parameter.vary">
<code class="descname">vary</code><a class="headerlink" href="#refnx.analysis.parameter.Parameter.vary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.parameter.Parameters">
<em class="property">class </em><code class="descclassname">refnx.analysis.parameter.</code><code class="descname">Parameters</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.UserList" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">collections.UserList</span></code></a></p>
<p>A collection of Parameters</p>
<dl class="method">
<dt id="refnx.analysis.parameter.Parameters.constrained_parameters">
<code class="descname">constrained_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.constrained_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameters.constrained_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>List of constrained parameters</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameters.flattened">
<code class="descname">flattened</code><span class="sig-paren">(</span><em>unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.flattened"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameters.flattened" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameters.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameters.lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameters.names">
<code class="descname">names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameters.names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.Parameters.nparam">
<code class="descname">nparam</code><a class="headerlink" href="#refnx.analysis.parameter.Parameters.nparam" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameters.nvary">
<code class="descname">nvary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.nvary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameters.nvary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.Parameters.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.parameter.Parameters.parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.parameter.Parameters.pvals">
<code class="descname">pvals</code><a class="headerlink" href="#refnx.analysis.parameter.Parameters.pvals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.parameter.Parameters.varying_parameters">
<code class="descname">varying_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.varying_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.Parameters.varying_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique list of varying parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>p</strong> – Unique list of varying parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="refnx.analysis.parameter.asMagicNumber">
<code class="descclassname">refnx.analysis.parameter.</code><code class="descname">asMagicNumber</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#asMagicNumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.asMagicNumber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="refnx.analysis.parameter.is_parameter">
<code class="descclassname">refnx.analysis.parameter.</code><code class="descname">is_parameter</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#is_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.is_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Test for Parameter-ness.</p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.parameter.is_parameters">
<code class="descclassname">refnx.analysis.parameter.</code><code class="descname">is_parameters</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#is_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.is_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Test for Parameter-ness.</p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.parameter.possibly_create_parameter">
<code class="descclassname">refnx.analysis.parameter.</code><code class="descname">possibly_create_parameter</code><span class="sig-paren">(</span><em>value</em>, <em>name=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#possibly_create_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.parameter.possibly_create_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>If supplied with a Parameter return it. If supplied with float, wrap it in
a Parameter instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><a class="reference internal" href="#refnx.analysis.Parameter" title="refnx.analysis.Parameter"><em>refnx.analysis.Parameter</em></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>parameter</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#refnx.analysis.Parameter" title="refnx.analysis.Parameter">refnx.analysis.Parameter</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-refnx.analysis.bounds">
<span id="refnx-analysis-bounds-module"></span><h2>refnx.analysis.bounds module<a class="headerlink" href="#module-refnx.analysis.bounds" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="refnx.analysis.bounds.Bounds">
<em class="property">class </em><code class="descclassname">refnx.analysis.bounds.</code><code class="descname">Bounds</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="refnx.analysis.bounds.Bounds.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Bounds.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of a value with the bounds</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.bounds.Bounds.rvs">
<code class="descname">rvs</code><span class="sig-paren">(</span><em>size=1</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds.rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Bounds.rvs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.bounds.Bounds.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Bounds.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a parameter value is within the support of the
distribution. If it isn’t then it returns a value that is within the
support.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.bounds.Interval">
<em class="property">class </em><code class="descclassname">refnx.analysis.bounds.</code><code class="descname">Interval</code><span class="sig-paren">(</span><em>lb=-inf</em>, <em>ub=inf</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.bounds.Bounds" title="refnx.analysis.bounds.Bounds"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.bounds.Bounds</span></code></a></p>
<dl class="attribute">
<dt id="refnx.analysis.bounds.Interval.lb">
<code class="descname">lb</code><a class="headerlink" href="#refnx.analysis.bounds.Interval.lb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.bounds.Interval.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Interval.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of a value with the bounds</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.bounds.Interval.rvs">
<code class="descname">rvs</code><span class="sig-paren">(</span><em>size=1</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval.rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Interval.rvs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.bounds.Interval.ub">
<code class="descname">ub</code><a class="headerlink" href="#refnx.analysis.bounds.Interval.ub" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.bounds.Interval.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.Interval.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a parameter value is within the support of the
Interval. If it isn’t then it returns a value that is within the
support.
If the Interval is closed (i.e. lower and upper bounds are both
specified) then invalid values will be corrected by random samples
taken between the lower and upper bounds.
If the interval is semi-open, only one of the bounds being
specified, then invalid values will be corrected by the value being
reflected by the same distance from the relevant limit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>val</strong> (<em>array-like</em>) – values to examine</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>valid</strong> – values within the support</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array-like</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">valid</span><span class="p">(</span><span class="mf">11.5</span><span class="p">)</span>
<span class="go">8.5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.bounds.PDF">
<em class="property">class </em><code class="descclassname">refnx.analysis.bounds.</code><code class="descname">PDF</code><span class="sig-paren">(</span><em>rv</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.PDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.bounds.Bounds" title="refnx.analysis.bounds.Bounds"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.bounds.Bounds</span></code></a></p>
<dl class="method">
<dt id="refnx.analysis.bounds.PDF.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.PDF.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of a value with the bounds</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.bounds.PDF.rvs">
<code class="descname">rvs</code><span class="sig-paren">(</span><em>size=1</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF.rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.PDF.rvs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.bounds.PDF.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.bounds.PDF.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a parameter value is within the support of the
distribution. If it isn’t then it returns a <em>random</em> value that is
within the support.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>val</strong> (<em>array-like</em>) – values to examine</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>valid</strong> – values within the support</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array-like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-refnx.analysis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-refnx.analysis" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="refnx.analysis.BaseObjective">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">BaseObjective</code><span class="sig-paren">(</span><em>p</em>, <em>lnlike</em>, <em>lnprior=None</em>, <em>fcn_args=()</em>, <em>fcn_kwds=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Don’t necessarily have to use Parameters, could use np.array</p>
<dl class="method">
<dt id="refnx.analysis.BaseObjective.covar">
<code class="descname">covar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.covar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective.covar" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>covar</strong> – The covariance matrix for the fitting system</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.BaseObjective.lnlike">
<code class="descname">lnlike</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.lnlike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Log-likelihood probability function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnlike</strong> – log-likelihood probability.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.BaseObjective.lnprior">
<code class="descname">lnprior</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Log-prior probability function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprior</strong> – log-prior probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.BaseObjective.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Log-probability function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprob</strong> – log-probability.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The log probability is the sum is the sum of the log-prior and
log-likelihood probabilities. Does not set the parameter attribute.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.BaseObjective.nll">
<code class="descname">nll</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.nll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective.nll" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative log-likelihood function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nll</strong> – negative log-likelihood</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.BaseObjective.setp">
<code class="descname">setp</code><span class="sig-paren">(</span><em>pvals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.setp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective.setp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters from pvals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em>) – Array containing the values to be tested.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.BaseObjective.varying_parameters">
<code class="descname">varying_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#BaseObjective.varying_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.BaseObjective.varying_parameters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>varying_parameters</strong> – The parameters varying in this objective function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.Bounds">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">Bounds</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="refnx.analysis.Bounds.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Bounds.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of a value with the bounds</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Bounds.rvs">
<code class="descname">rvs</code><span class="sig-paren">(</span><em>size=1</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds.rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Bounds.rvs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Bounds.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Bounds.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Bounds.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a parameter value is within the support of the
distribution. If it isn’t then it returns a value that is within the
support.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.CurveFitter">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">CurveFitter</code><span class="sig-paren">(</span><em>objective</em>, <em>nwalkers=200</em>, <em>ntemps=-1</em>, <em>**mcmc_kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.CurveFitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Analyse a curvefitting system (with MCMC sampling)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>objective</strong> (<a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><em>refnx.analysis.Objective</em></a>) – The <a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Objective</span></code></a> to be analysed.</li>
<li><strong>nwalkers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – How many walkers you would like the sampler to have. Must be an
even number. The more walkers the better.</li>
<li><strong>ntemps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em>, </em><em>optional</em>) – If <cite>ntemps == -1</cite>, then an <code class="xref py py-class docutils literal"><span class="pre">emcee.EnsembleSampler</span></code> is used
during the <cite>sample</cite> method.
Otherwise, or if <cite>ntemps is None</cite> then parallel tempering is
used with a <code class="xref py py-class docutils literal"><span class="pre">emcee.PTSampler</span></code> object during the <cite>sample</cite>
method, with <cite>ntemps</cite> specifing the number of temperatures. Can be
<cite>None</cite>, in which case the <cite>Tmax</cite> keyword argument sets the maximum
temperature. Parallel Tempering is useful if you expect your
posterior distribution to be multi-modal.</li>
<li><strong>mcmc_kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)"><em>dict</em></a>) – Keywords used to create the <code class="xref py py-class docutils literal"><span class="pre">emcee.EnsembleSampler</span></code> or
<code class="xref py py-class docutils literal"><span class="pre">emcee.PTSampler</span></code> objects.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>See the documentation at <a class="reference external" href="http://dan.iel.fm/emcee/current/api/">http://dan.iel.fm/emcee/current/api/</a> for
further details on what keywords are permitted, and for further
information on Parallel Tempering. The <cite>pool</cite> and <cite>threads</cite> keywords
are ignored here. Specification of parallel threading is done with the
<cite>pool</cite> argument in the <cite>sample</cite> method.</p>
<dl class="method">
<dt id="refnx.analysis.CurveFitter.acf">
<code class="descname">acf</code><span class="sig-paren">(</span><em>nburn=0</em>, <em>nthin=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.acf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.CurveFitter.acf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the autocorrelation function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>acfs</strong> – The autocorrelation function, acfs.shape=(lags, nvary)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.CurveFitter.chain">
<code class="descname">chain</code><a class="headerlink" href="#refnx.analysis.CurveFitter.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>MCMC chain belonging to CurveFitter.sampler</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>chain</strong> – The MCMC chain belonging to CurveFitter.sampler</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)">array</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.CurveFitter.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>method='L-BFGS-B'</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.CurveFitter.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the maximum log-likelihood estimate (mode) of the objective. For
a least-squares objective this would correspond to lowest chi2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – <p>which method to use for the optimisation. One of:</p>
<ul>
<li><cite>’least_squares’</cite>: <cite>scipy.optimize.least_squares</cite>.</li>
<li><cite>’L-BFGS-B’</cite>: L-BFGS-B</li>
<li><cite>’differential_evolution’</cite>: differential evolution</li>
</ul>
<p>You can also choose many of the minimizers from
<code class="docutils literal"><span class="pre">scipy.optimize.minimize</span></code>.</p>
</li>
<li><strong>kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)"><em>dict</em></a>) – Additional arguments are passed to the underlying minimization
method.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result, covar</strong> – <cite>result.x</cite> contains the best fit parameters
<cite>result.covar</cite> is the covariance matrix for the fit.
<cite>result.stderr</cite> is the uncertainties on each of the fit parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">OptimizeResult, np.ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <cite>objective</cite> supplies a <cite>residuals</cite> method then <cite>least_squares</cite>
can be used. Otherwise the <cite>nll</cite> method of the <cite>objective</cite> is
minimised. Use this method just before a sampling run.
If <cite>self.objective.parameters</cite> is a <cite>Parameters</cite> instance, then each
of the varying parameters has its value updated by the fit, and each
<cite>Parameter</cite> has a <cite>stderr</cite> attribute which represents the uncertainty
on the fit parameter.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.CurveFitter.initialise">
<code class="descname">initialise</code><span class="sig-paren">(</span><em>pos='covar'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.initialise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.CurveFitter.initialise" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the emcee walkers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> or </em><em>np.ndarray</em>) – <p>Method for initialising the emcee walkers. One of:</p>
<ul class="simple">
<li>’covar’, use the estimated covariance of the system.</li>
<li>’jitter’, add a small amount of gaussian noise to each parameter</li>
<li>’prior’, sample random locations from the prior</li>
<li><dl class="first docutils">
<dt>pos, an array that specifies a snapshot of the walkers. Has shape</dt>
<dd><dl class="first last docutils">
<dt><cite>(nwalkers, ndim)</cite>, or <cite>(ntemps, nwalkers, ndim)</cite> if parallel</dt>
<dd>tempering is employed. You can also provide a previously
created chain.</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.CurveFitter.initialise_with_chain">
<code class="descname">initialise_with_chain</code><span class="sig-paren">(</span><em>chain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.initialise_with_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.CurveFitter.initialise_with_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise sampler with a pre-existing chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chain</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)"><em>array</em></a>) – Array of size <cite>(ntemps, nwalkers, steps, ndim)</cite> or
<cite>(nwalkers, steps, ndim)</cite>, containing a chain from a previous
sampling run.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.CurveFitter.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><em>steps</em>, <em>nthin=1</em>, <em>random_state=None</em>, <em>f=None</em>, <em>callback=None</em>, <em>verbose=True</em>, <em>pool=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#CurveFitter.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.CurveFitter.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs sampling from the objective.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Iterate the sampler by a number of steps</li>
<li><strong>nthin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – only store every <cite>nthin</cite> samples from the chain. <cite>nthin</cite> should be
a divisor of <cite>steps</cite>.</li>
<li><strong>random_state</strong> (int or <cite>np.random.RandomState</cite>, optional) – If <cite>random_state</cite> is an int, a new <cite>np.random.RandomState</cite> instance
is used, seeded with <cite>random_state</cite>.
If <cite>random_state</cite> is already a <cite>np.random.RandomState</cite> instance,
then that <cite>np.random.RandomState</cite> instance is used. Specify
<cite>random_state</cite> for repeatable sampling</li>
<li><strong>f</strong> (<em>file-like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – File to incrementally save chain progress to. Each row in the file
is a flattened array of size <cite>(nwalkers, ndim)</cite> or
<cite>(ntemps, nwalkers, ndim)</cite>. There should be <cite>steps</cite> rows in the
file.</li>
<li><strong>callback</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a>) – callback function to be called at each iteration step</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – Gives updates on the sampling progress</li>
<li><strong>pool</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>map-like object</em><em>, </em><em>optional</em>) – If <cite>pool</cite> is an <cite>int</cite> then it specifies the number of threads to
use for parallelization. If <cite>pool == 0</cite>, then all CPU’s are used.
If pool is an object with a map method that follows the same
calling sequence as the built-in map function, then this pool is
used for parallelisation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Please see <code class="xref py py-class docutils literal"><span class="pre">emcee.EnsembleSampler</span></code> for its detailed behaviour.
For example, the chain is contained in <cite>CurveFitter.sampler.chain</cite> and
has shape <cite>(nwalkers, iterations, ndim)</cite>. If you wish to ‘burn’ a
number of samples to start with then use the following pattern:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># we&#39;ll burn the first 500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitter</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># after you&#39;ve run those, then discard them by resetting the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># sampler.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitter</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now do a production run only saving 1 in every 50 samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitter</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">nthin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>One can also burn and thin in <cite>Curvefitter.process_chain</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.GlobalObjective">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">GlobalObjective</code><span class="sig-paren">(</span><em>objectives</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.GlobalObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.objective.Objective" title="refnx.analysis.objective.Objective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.objective.Objective</span></code></a></p>
<p>Global Objective function for simultaneous fitting with
<cite>refnx.analysis.CurveFitter</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>objectives</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a>) – list of <a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Objective</span></code></a> objects</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="refnx.analysis.GlobalObjective.lnlike">
<code class="descname">lnlike</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective.lnlike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.GlobalObjective.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelhood of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnlike</strong> – log-likelihood probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.GlobalObjective.lnprior">
<code class="descname">lnprior</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.GlobalObjective.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-prior of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a><em>, </em><em>optional</em>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprior</strong> – log-prior probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.GlobalObjective.npoints">
<code class="descname">npoints</code><a class="headerlink" href="#refnx.analysis.GlobalObjective.npoints" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>int</strong> number of data points in all the objectives.</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.GlobalObjective.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.GlobalObjective.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Parameters</span></code></a> associated with all the objectives.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.GlobalObjective.residuals">
<code class="descname">residuals</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#GlobalObjective.residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.GlobalObjective.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenated residuals for each of the
<a class="reference internal" href="#refnx.analysis.Objective.residuals" title="refnx.analysis.Objective.residuals"><code class="xref py py-meth docutils literal"><span class="pre">refnx.analysis.Objective.residuals</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>residuals</strong> – Concatenated <a class="reference internal" href="#refnx.analysis.Objective.residuals" title="refnx.analysis.Objective.residuals"><code class="xref py py-meth docutils literal"><span class="pre">refnx.analysis.Objective.residuals</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.GlobalObjective.use_weights">
<code class="descname">use_weights</code><a class="headerlink" href="#refnx.analysis.GlobalObjective.use_weights" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>bool</strong> is data weighting being used for all the objectives?</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.GlobalObjective.weighted">
<code class="descname">weighted</code><a class="headerlink" href="#refnx.analysis.GlobalObjective.weighted" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>bool</strong> do all the datasets have y_err?</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.Interval">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">Interval</code><span class="sig-paren">(</span><em>lb=-inf</em>, <em>ub=inf</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.bounds.Bounds" title="refnx.analysis.bounds.Bounds"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.bounds.Bounds</span></code></a></p>
<dl class="attribute">
<dt id="refnx.analysis.Interval.lb">
<code class="descname">lb</code><a class="headerlink" href="#refnx.analysis.Interval.lb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Interval.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Interval.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of a value with the bounds</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Interval.rvs">
<code class="descname">rvs</code><span class="sig-paren">(</span><em>size=1</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval.rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Interval.rvs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Interval.ub">
<code class="descname">ub</code><a class="headerlink" href="#refnx.analysis.Interval.ub" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Interval.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#Interval.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Interval.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a parameter value is within the support of the
Interval. If it isn’t then it returns a value that is within the
support.
If the Interval is closed (i.e. lower and upper bounds are both
specified) then invalid values will be corrected by random samples
taken between the lower and upper bounds.
If the interval is semi-open, only one of the bounds being
specified, then invalid values will be corrected by the value being
reflected by the same distance from the relevant limit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>val</strong> (<em>array-like</em>) – values to examine</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>valid</strong> – values within the support</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array-like</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">valid</span><span class="p">(</span><span class="mf">11.5</span><span class="p">)</span>
<span class="go">8.5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.MCMCResult">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">MCMCResult</code><span class="sig-paren">(</span><em>name</em>, <em>param</em>, <em>stderr</em>, <em>chain</em>, <em>median</em><span class="sig-paren">)</span><a class="headerlink" href="#refnx.analysis.MCMCResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a></p>
<dl class="attribute">
<dt id="refnx.analysis.MCMCResult.chain">
<code class="descname">chain</code><a class="headerlink" href="#refnx.analysis.MCMCResult.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.MCMCResult.median">
<code class="descname">median</code><a class="headerlink" href="#refnx.analysis.MCMCResult.median" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.MCMCResult.name">
<code class="descname">name</code><a class="headerlink" href="#refnx.analysis.MCMCResult.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.MCMCResult.param">
<code class="descname">param</code><a class="headerlink" href="#refnx.analysis.MCMCResult.param" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.MCMCResult.stderr">
<code class="descname">stderr</code><a class="headerlink" href="#refnx.analysis.MCMCResult.stderr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.Model">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>parameters</em>, <em>fitfunc=None</em>, <em>fcn_args=()</em>, <em>fcn_kwds=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Calculates a generative model (dependent variable), given parameters
and independent variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)"><em>array</em></a><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – Parameters to calculate the model with</li>
<li><strong>fitfunc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a><em>, </em><em>optional</em>) – A function that calculates the generative model. Should have the
signature <code class="docutils literal"><span class="pre">fitfunc(x,</span> <span class="pre">parameters,</span> <span class="pre">*fcn_args,</span> <span class="pre">**fcn__kwds)</span></code> where <cite>x</cite>
is an array-like specifying the independent variables, and
<cite>parameters</cite> are the parameters required to calculate the model.
<cite>fcn_args</cite> and <cite>fcn_kwds</cite> can be used to supply additional arguments to
to <cite>fitfunc</cite>.</li>
<li><strong>fcn_args</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Supplies extra arguments to <cite>fitfunc</cite></li>
<li><strong>fcn_kwds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)"><em>dict</em></a><em>, </em><em>optional</em>) – Supplies keyword arguments to <cite>fitfunc</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>It is not necessary to supply <cite>fitfunc</cite> to create a <cite>Model</cite> <em>iff</em> you are
inheriting <cite>Model</cite> and are also overriding <cite>Model.model</cite>.</p>
<dl class="attribute">
<dt id="refnx.analysis.Model.fitfunc">
<code class="descname">fitfunc</code><a class="headerlink" href="#refnx.analysis.Model.fitfunc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Model.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#Model.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Model.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>The model can add additional terms to it’s log-probability. However,
it should _not_ include lnprob from any of the parameters. That is
calculated by objective.lnprior.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Model.model">
<code class="descname">model</code><span class="sig-paren">(</span><em>x</em>, <em>p=None</em>, <em>x_err=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#Model.model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Model.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a generative model(dependent variable), given parameters and
independent variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array-like</em>) – Independent variable.</li>
<li><strong>p</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – Parameters to supply to the generative function.</li>
<li><strong>x_err</strong> (<em>optional</em>) – Uncertainty in <cite>x</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>generative</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array-like or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The interpretation of <cite>x</cite>, <cite>p</cite>, and <cite>x_err</cite> is up to the <cite>fitfunc</cite>
supplied during construction of this object (or the overridden <cite>model</cite>
method of this object).</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Model.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.Model.parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.Objective">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">Objective</code><span class="sig-paren">(</span><em>model</em>, <em>data</em>, <em>lnsigma=None</em>, <em>use_weights=True</em>, <em>transform=None</em>, <em>lnprob_extra=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.objective.BaseObjective" title="refnx.analysis.objective.BaseObjective"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.objective.BaseObjective</span></code></a></p>
<p>Objective function for using with curvefitters such as
<cite>refnx.analysis.curvefitter.CurveFitter</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<a class="reference internal" href="#refnx.analysis.Model" title="refnx.analysis.Model"><em>refnx.analysis.Model</em></a>) – the generative model function. One can also provide an object that
inherits <cite>refnx.analysis.Model</cite>.</li>
<li><strong>data</strong> (<a class="reference internal" href="refnx.dataset.html#refnx.dataset.Data1D" title="refnx.dataset.Data1D"><em>refnx.dataset.Data1D</em></a>) – data to be analysed.</li>
<li><strong>lnsigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><a class="reference internal" href="#refnx.analysis.Parameter" title="refnx.analysis.Parameter"><em>refnx.analysis.Parameter</em></a><em>, </em><em>optional</em>) – <p>Used if the  experimental uncertainty (<cite>data.y_err</cite>) underestimated by
a constant fractional amount. The experimental uncertainty is modified
as:</p>
<p><cite>s_n**2 = y_err**2 + exp(lnsigma * 2) * model**2</cite></p>
<p>See <cite>Objective.lnlike</cite> for more details.</p>
</li>
<li><strong>use_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – use experimental uncertainty in calculation of residuals and
lnlike, if available. If this is set to False, then you should also
set <cite>self.lnsigma.vary = False</cite>, it will have no effect on the fit.</li>
<li><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a><em>, </em><em>optional</em>) – the model, data and data uncertainty are transformed by this
function before calculating the likelihood/residuals. Has the
signature <cite>transform(data.x, y, y_err=None)</cite>, returning the tuple
(<cite>transformed_y, transformed_y_err</cite>).</li>
<li><strong>lnprob_extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a><em>, </em><em>optional</em>) – user specifiable log-probability term. This contribution is in
addition to the log-prior term of the <cite>model</cite> parameters, and
<cite>model.lnprob</cite>, as well as the log-likelihood of the <cite>data</cite>. Has
signature:
<cite>lnprob_extra(model, data)</cite>. The <cite>model</cite> will already possess
updated parameters. Beware of including the same log-probability
terms more than once.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For parallelisation <cite>lnprob_extra</cite> needs to be picklable.</p>
<dl class="method">
<dt id="refnx.analysis.Objective.chisqr">
<code class="descname">chisqr</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.chisqr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.chisqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the chi-squared value for a given fitting system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>chisqr</strong> – Chi-squared value, <cite>np.sum(residuals**2)</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.covar">
<code class="descname">covar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.covar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.covar" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the covariance matrix of the curvefitting system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>covar</strong> – Covariance matrix</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.generative">
<code class="descname">generative</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.generative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.generative" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the generative (dependent variable) function associated with
the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>model</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.lnlike">
<code class="descname">lnlike</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.lnlike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelhood of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnlike</strong> – log-likelihood probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The log-likelihood is calculated as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">lnlike</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">model</span> <span class="o">/</span> <span class="n">s_n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">s_n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>where</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">s_n</span><span class="o">**</span><span class="mi">2</span> <span class="o">=</span> <span class="n">y_err</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">lnsigma</span><span class="p">)</span> <span class="o">*</span> <span class="n">model</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.lnprior">
<code class="descname">lnprior</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-prior of the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprior</strong> – log-prior probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The log-prior is calculated as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">lnprior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">lnprob</span><span class="p">()</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">varying_parameters</span><span class="p">())</span>
<span class="n">lnprior</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lnprob</span><span class="p">()</span>
<span class="n">lnprior</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lnprob_extra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>The major components of the log-prior probability are from the varying
parameters and the Model used to construct the Objective.
<cite>self.model.lnprob</cite> should not include any contributions from
<cite>self.model.parameters</cite> otherwise they’ll be counted more than once.
The same argument applies to the user specifiable <cite>lnprob_extra</cite>
function.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-probability of the curvefitting system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>lnprob</strong> – log-probability</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The overall log-probability is the sum of the log-prior and
log-likelihood. The log-likelihood is not calculated if the log-prior
is impossible (<cite>lnprior == -np.inf</cite>).</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.nll">
<code class="descname">nll</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.nll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.nll" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative log-likelihood function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nll</strong> – negative log-likelihood</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Objective.npoints">
<code class="descname">npoints</code><a class="headerlink" href="#refnx.analysis.Objective.npoints" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>int</strong> the number of points in the dataset.</p>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Objective.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.Objective.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.Parameters</span></code></a>, all the Parameters contained in the
fitting system.</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.pgen">
<code class="descname">pgen</code><span class="sig-paren">(</span><em>ngen=1000</em>, <em>nburn=0</em>, <em>nthin=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.pgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.pgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield random parameter vectors (only those varying) from the MCMC
samples. The objective state is not altered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ngen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – the number of samples to yield. The actual number of samples
yielded is <cite>min(ngen, chain.size)</cite></li>
<li><strong>nburn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – discard this many steps from the start of the chain</li>
<li><strong>nthin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – only accept every <cite>nthin</cite> samples from the chain</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><strong>pvec</strong> (<em>np.ndarray</em>) – A randomly chosen parameter vector</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the data/model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Numeric values for the Parameter’s that are varying</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>fig, ax</strong> – <cite>matplotlib</cite> figure and axes objects.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.Figure</span></code>, <code class="xref py py-class docutils literal"><span class="pre">matplotlib.Axes</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.residuals">
<code class="descname">residuals</code><span class="sig-paren">(</span><em>pvals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the residuals for a given fitting system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>residuals</strong> – Residuals, <cite>(data.y - model) / y_err</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.setp">
<code class="descname">setp</code><span class="sig-paren">(</span><em>pvals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.setp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.setp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters from pvals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvals</strong> (<em>array-like</em><em> or </em><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters"><em>refnx.analysis.Parameters</em></a>) – values for the varying or entire set of parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Objective.varying_parameters">
<code class="descname">varying_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Objective.varying_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Objective.varying_parameters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>varying_parameters</strong> – The varying Parameter objects allowed to vary during the fit.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#refnx.analysis.Parameters" title="refnx.analysis.Parameters">refnx.analysis.Parameters</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Objective.weighted">
<code class="descname">weighted</code><a class="headerlink" href="#refnx.analysis.Objective.weighted" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>bool</strong> does the data have weights (<cite>data.y_err</cite>)?</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.PDF">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">PDF</code><span class="sig-paren">(</span><em>rv</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.PDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.bounds.Bounds" title="refnx.analysis.bounds.Bounds"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.bounds.Bounds</span></code></a></p>
<dl class="method">
<dt id="refnx.analysis.PDF.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.PDF.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of a value with the bounds</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.PDF.rvs">
<code class="descname">rvs</code><span class="sig-paren">(</span><em>size=1</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF.rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.PDF.rvs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.PDF.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/bounds.html#PDF.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.PDF.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a parameter value is within the support of the
distribution. If it isn’t then it returns a <em>random</em> value that is
within the support.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>val</strong> (<em>array-like</em>) – values to examine</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>valid</strong> – values within the support</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array-like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.Parameter">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">Parameter</code><span class="sig-paren">(</span><em>value=0.0, name=None, bounds=[-inf, inf], vary=False, constraint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refnx.analysis.parameter.BaseParameter" title="refnx.analysis.parameter.BaseParameter"><code class="xref py py-class docutils literal"><span class="pre">refnx.analysis.parameter.BaseParameter</span></code></a></p>
<dl class="attribute">
<dt id="refnx.analysis.Parameter.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#refnx.analysis.Parameter.bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Parameter.constraint">
<code class="descname">constraint</code><a class="headerlink" href="#refnx.analysis.Parameter.constraint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameter.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><em>pval=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameter.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood probability of the parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>prob</strong> – log-likelihood probability of the parameter</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameter.range">
<code class="descname">range</code><span class="sig-paren">(</span><em>lower</em>, <em>upper</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameter.range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameter.setp">
<code class="descname">setp</code><span class="sig-paren">(</span><em>value=None</em>, <em>vary=None</em>, <em>bounds=None</em>, <em>constraint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.setp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameter.setp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set several attributes of the parameter at once</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameter.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameter.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameter.valid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Parameter.value">
<code class="descname">value</code><a class="headerlink" href="#refnx.analysis.Parameter.value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Parameter.vary">
<code class="descname">vary</code><a class="headerlink" href="#refnx.analysis.Parameter.vary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.Parameters">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">Parameters</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.UserList" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">collections.UserList</span></code></a></p>
<p>A collection of Parameters</p>
<dl class="method">
<dt id="refnx.analysis.Parameters.constrained_parameters">
<code class="descname">constrained_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.constrained_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameters.constrained_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>List of constrained parameters</p>
</dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameters.flattened">
<code class="descname">flattened</code><span class="sig-paren">(</span><em>unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.flattened"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameters.flattened" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameters.lnprob">
<code class="descname">lnprob</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameters.lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameters.names">
<code class="descname">names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameters.names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Parameters.nparam">
<code class="descname">nparam</code><a class="headerlink" href="#refnx.analysis.Parameters.nparam" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameters.nvary">
<code class="descname">nvary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.nvary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameters.nvary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Parameters.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#refnx.analysis.Parameters.parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="refnx.analysis.Parameters.pvals">
<code class="descname">pvals</code><a class="headerlink" href="#refnx.analysis.Parameters.pvals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refnx.analysis.Parameters.varying_parameters">
<code class="descname">varying_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#Parameters.varying_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Parameters.varying_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique list of varying parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>p</strong> – Unique list of varying parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refnx.analysis.Transform">
<em class="property">class </em><code class="descclassname">refnx.analysis.</code><code class="descname">Transform</code><span class="sig-paren">(</span><em>form</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/objective.html#Transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.Transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Mathematical transforms of numeric data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>form</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – <p>One of:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>’lin’</dt>
<dd>No transform is made</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’logY’</dt>
<dd>log10 transform</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’YX4’</dt>
<dd>YX**4 transform</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’YX2’</dt>
<dd>YX**2 transform</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>None</dt>
<dd>No transform is made</dd>
</dl>
</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>You ask for a transform to be carried out by calling the Transform object
directly.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="s1">&#39;logY&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_err</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.fitfunc">
<code class="descclassname">refnx.analysis.</code><code class="descname">fitfunc</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/model.html#fitfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.fitfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator that can be used to say if something is a fitfunc.</p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.is_parameter">
<code class="descclassname">refnx.analysis.</code><code class="descname">is_parameter</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#is_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.is_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Test for Parameter-ness.</p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.is_parameters">
<code class="descclassname">refnx.analysis.</code><code class="descname">is_parameters</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#is_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.is_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Test for Parameter-ness.</p>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.load_chain">
<code class="descclassname">refnx.analysis.</code><code class="descname">load_chain</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#load_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.load_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a chain from disk. Does not change the state of a CurveFitter
object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> or </em><em>file-like</em>) – File containing the chain.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>chain</strong> – The loaded chain - <cite>(nwalkers, nsteps, ndim)</cite> or
<cite>(ntemps, nwalkers, nsteps, ndim)</cite></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)">array</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.possibly_create_parameter">
<code class="descclassname">refnx.analysis.</code><code class="descname">possibly_create_parameter</code><span class="sig-paren">(</span><em>value</em>, <em>name=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/parameter.html#possibly_create_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.possibly_create_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>If supplied with a Parameter return it. If supplied with float, wrap it in
a Parameter instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><a class="reference internal" href="#refnx.analysis.Parameter" title="refnx.analysis.Parameter"><em>refnx.analysis.Parameter</em></a>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>parameter</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#refnx.analysis.Parameter" title="refnx.analysis.Parameter">refnx.analysis.Parameter</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="refnx.analysis.process_chain">
<code class="descclassname">refnx.analysis.</code><code class="descname">process_chain</code><span class="sig-paren">(</span><em>objective</em>, <em>chain</em>, <em>nburn=0</em>, <em>nthin=1</em>, <em>flatchain=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refnx/analysis/curvefitter.html#process_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refnx.analysis.process_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Process the chain produced by a sampler for a given Objective</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>objective</strong> (<a class="reference internal" href="#refnx.analysis.Objective" title="refnx.analysis.Objective"><em>refnx.analysis.Objective</em></a>) – The Objective function that the Posterior was sampled for</li>
<li><strong>chain</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.6)"><em>array</em></a>) – The MCMC chain</li>
<li><strong>nburn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – discard this many steps from the start of the chain</li>
<li><strong>nthin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – only accept every <cite>nthin</cite> samples from the chain</li>
<li><strong>flatchain</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – collapse the walkers down into a single dimension.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>[(param, stderr, chain)]</strong> – List of (param, stderr, chain) tuples.
If <cite>isinstance(objective.parameters, Parameters)</cite> then <cite>param</cite> is a
<cite>Parameter</cite> instance. <cite>param.value</cite>, <cite>param.stderr</cite> and
<cite>param.chain</cite> will contain the median, stderr and chain samples,
respectively. Otherwise <cite>param</cite> will be a float representing the
median of the chain samples.
<cite>stderr</cite> is the half width of the [15.87, 84.13] spread (similar to
standard deviation) and <cite>chain</cite> is an array containing the MCMC
samples for that parameter.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The chain should have the shape <cite>(nwalkers, iterations, nvary)</cite> or
<cite>(ntemps, nwalkers, iterations, nvary)</cite> if parallel tempering was
employed.
The burned and thinned chain is created via:
<cite>chain[…, nburn::nthin, :]</cite>.
Note, if parallel tempering is employed, then only the first row
of the parallel tempering chain is processed and returned as it
corresponds to the (lowest energy) target distribution.
If <cite>flatten is True</cite> then the burned/thinned chain is reshaped and
<cite>arr.reshape(-1, nvary)</cite> is returned.
This function has the effect of setting the parameter stderr’s.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">refnx.analysis package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-refnx.analysis.curvefitter">refnx.analysis.curvefitter module</a></li>
<li><a class="reference internal" href="#module-refnx.analysis.objective">refnx.analysis.objective module</a></li>
<li><a class="reference internal" href="#module-refnx.analysis.model">refnx.analysis.model module</a></li>
<li><a class="reference internal" href="#module-refnx.analysis.parameter">refnx.analysis.parameter module</a></li>
<li><a class="reference internal" href="#module-refnx.analysis.bounds">refnx.analysis.bounds module</a></li>
<li><a class="reference internal" href="#module-refnx.analysis">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/refnx.analysis.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015-2017, Andrew Nelson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/refnx.analysis.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>